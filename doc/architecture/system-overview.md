# ĞĞ±Ğ·Ğ¾Ñ€ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ CodeLab Core Service v0.2.0

## ğŸ“– Ğ’Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ

CodeLab Core Service - ÑÑ‚Ğ¾ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¼ÑƒĞ»ÑŒÑ‚Ğ¸Ğ°Ğ³ĞµĞ½Ñ‚Ğ½Ğ°Ñ AI Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ° Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ¸Ğ·Ğ¾Ğ»ÑÑ†Ğ¸ĞµĞ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹. ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½Ğ° Ğ½Ğ° **Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°Ñ…** - ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ‹, ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ Ğ¸Ğ¼ĞµĞµÑ‚ ÑĞ²Ğ¾Ğ¸Ñ… Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ², ÑĞµÑÑĞ¸Ğ¸ Ñ‡Ğ°Ñ‚Ğ¾Ğ² Ğ¸ ÑĞµĞ¼Ğ°Ğ½Ñ‚Ğ¸Ñ‡ĞµÑĞºÑƒÑ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ.

---

## ğŸ¯ ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹

### 1. 100% Ğ˜Ğ·Ğ¾Ğ»ÑÑ†Ğ¸Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹

- **User Level**: ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ²Ğ¸Ğ´Ğ¸Ñ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑĞ²Ğ¾Ğ¸ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ‹
- **Project Level**: ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ ÑĞ¾Ğ±ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğµ Ğ°Ğ³ĞµĞ½Ñ‚Ñ‹ Ğ¸ ÑĞµÑÑĞ¸Ğ¸
- **Agent Level**: ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ°Ğ³ĞµĞ½Ñ‚ Ğ¸Ğ¼ĞµĞµÑ‚ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Qdrant ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚
- **Middleware**: ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğ½Ğ° Ğ²ÑĞµÑ… `/my/*` endpoints

```
User123
â”œâ”€ Project A
â”‚  â”œâ”€ CodeAssistant (ÑĞ¾ ÑĞ²Ğ¾Ğ¸Ğ¼ Qdrant ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ¼)
â”‚  â”œâ”€ DataAnalyst (ÑĞ¾ ÑĞ²Ğ¾Ğ¸Ğ¼ Qdrant ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ¼)
â”‚  â””â”€ Chat Sessions
â””â”€ Project B
   â”œâ”€ FrontendDeveloper
   â”œâ”€ BackendDeveloper
   â””â”€ Chat Sessions

User456 (Ğ¸Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½, Ğ½Ğµ Ğ²Ğ¸Ğ´Ğ¸Ñ‚ User123 Ñ€ĞµÑÑƒÑ€ÑÑ‹)
â”œâ”€ Project C
â”‚  â””â”€ ...
```

### 2. Ğ”Ğ²Ğ° Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸

#### âš¡ ĞŸÑ€ÑĞ¼Ğ¾Ğ¹ Ğ²Ñ‹Ğ·Ğ¾Ğ² (Direct Call) - 1-2 ÑĞµĞº
- ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ ÑƒĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°: `target_agent: "CodeAssistant"`
- ĞĞ³ĞµĞ½Ñ‚ ÑÑ€Ğ°Ğ·Ñƒ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ
- ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ°, Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ
- Ğ˜Ğ´ĞµĞ°Ğ»ÑŒĞ½Ğ¾ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾ÑÑ‚Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²

#### ğŸ§  ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼ (Orchestrated) - 5-10 ÑĞµĞº
- ĞÑ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
- ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡ (DAG)
- ĞšĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ²
- Ğ˜Ğ´ĞµĞ°Ğ»ÑŒĞ½Ğ¾ Ğ´Ğ»Ñ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ¼Ğ½Ğ¾Ğ³Ğ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡

### 3. Ğ¡ĞµĞ¼Ğ°Ğ½Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°

- **Per-Agent Storage**: ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ°Ğ³ĞµĞ½Ñ‚ Ğ¸Ğ¼ĞµĞµÑ‚ ÑĞ²Ğ¾Ñ Qdrant ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ
- **RAG Integration**: ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº Ñ€ĞµĞ»ĞµĞ²Ğ°Ğ½Ñ‚Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ° Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞµ
- **ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ**: Ğ”Ğ¾ 1M+ Ğ²ĞµĞºÑ‚Ğ¾Ñ€Ğ¾Ğ² Ğ½Ğ° Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
- **ĞœĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ**: Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ñ‚Ğ¸Ğ¿Ñƒ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ, Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸, ÑƒÑĞ¿ĞµÑ…Ñƒ

### 4. Real-time Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ

- **Server-Sent Events (SSE)**: NDJSON Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ´Ğ»Ñ streaming
- **Event Buffering**: Redis ĞºÑÑˆĞ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ (TTL 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚)
- **Heartbeat**: ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ
- **Auto-reconnect**: ĞšĞ»Ğ¸ĞµĞ½Ñ‚ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¿ĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒÑÑ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ

---

## ğŸ—ï¸ Ğ’Ñ‹ÑĞ¾ĞºĞ¾ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CLIENT LAYER                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Web UI / Mobile App / API Client                    â”‚   â”‚
â”‚  â”‚  (JWT Auth + User Isolation Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ)         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              API GATEWAY LAYER (FastAPI)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ User Isolation Middleware (JWT â†’ user_id)           â”‚   â”‚
â”‚  â”‚ Project Validation Middleware (project ownership)    â”‚   â”‚
â”‚  â”‚ Routes:                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ /my/projects/*              (CRUD Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¾Ğ²)     â”‚   â”‚
â”‚  â”‚  â”œâ”€ /my/projects/{pid}/agents/* (Ğ°Ğ³ĞµĞ½Ñ‚Ñ‹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°)   â”‚   â”‚
â”‚  â”‚  â”œâ”€ /my/projects/{pid}/chat/*   (Ñ‡Ğ°Ñ‚ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°)      â”‚   â”‚
â”‚  â”‚  â””â”€ /health /ready              (Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒĞµ)         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           BUSINESS LOGIC LAYER                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  WorkerSpaceManager                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€ create_worker_space(project_id)                â”‚   â”‚
â”‚  â”‚  â”œâ”€ get_worker_space(project_id)                   â”‚   â”‚
â”‚  â”‚  â””â”€ delete_worker_space(project_id)                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Per-Project Components                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ Agent Manager (ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ/ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ/Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ)   â”‚   â”‚
â”‚  â”‚  â”œâ”€ Agent Bus (ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ²)                â”‚   â”‚
â”‚  â”‚  â”œâ”€ Contextual Agents (Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ñ RAG)           â”‚   â”‚
â”‚  â”‚  â”œâ”€ Orchestrator (Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ DAG)                â”‚   â”‚
â”‚  â”‚  â”œâ”€ Approval Manager (ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹)   â”‚   â”‚
â”‚  â”‚  â””â”€ Stream Manager (real-time ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ)             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼              â–¼              â–¼              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚PostgreSQL   â”‚  Redis   â”‚   â”‚ Qdrant â”‚   â”‚  LLM API     â”‚
    â”‚            â”‚          â”‚   â”‚        â”‚   â”‚              â”‚
    â”‚ Users      â”‚ Queues   â”‚   â”‚Vectors â”‚   â”‚ (OpenAI/etc) â”‚
    â”‚ Projects   â”‚ Cache    â”‚   â”‚RAG     â”‚   â”‚              â”‚
    â”‚ Agents     â”‚ Events   â”‚   â”‚Context â”‚   â”‚              â”‚
    â”‚ Sessions   â”‚ Sessions â”‚   â”‚        â”‚   â”‚              â”‚
    â”‚ Messages   â”‚          â”‚   â”‚        â”‚   â”‚              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

### API Gateway Layer

#### FastAPI Application (`app/main.py`)
- **ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: HTTP ÑĞµÑ€Ğ²ĞµÑ€ Ğ¸ Ñ‚Ğ¾Ñ‡ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ğ°
- **Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸**: FastAPI 0.115+, Uvicorn, Pydantic 2.0
- **Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸**:
  - ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğº routes
  - Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (Pydantic schemas)
  - Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ OpenAPI (Swagger/ReDoc)
  - CORS middleware Ğ´Ğ»Ñ Ñ„Ñ€Ğ¾Ğ½Ñ‚ĞµĞ½Ğ´Ğ°
  - Lifespan ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ (startup/shutdown)

#### User Isolation Middleware (`app/middleware/user_isolation.py`)
- **ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ user_id Ğ¸Ğ· JWT Ñ‚Ğ¾ĞºĞµĞ½Ğ° Ğ¸ Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ñ Ğ² ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚
- **Ğ›Ğ¾Ğ³Ğ¸ĞºĞ°**:
  1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº `Authorization: Bearer <token>`
  2. Ğ”ĞµĞºĞ¾Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ JWT Ñ‚Ğ¾ĞºĞµĞ½
  3. Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ `user_id` Ğ¸Ğ· claim `sub`
  4. Ğ˜Ğ½ÑŠĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² `request.state.user_id`
- **Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ°**: 401 Unauthorized ĞµÑĞ»Ğ¸ Ñ‚Ğ¾ĞºĞµĞ½ Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ¸Ğ»Ğ¸ Ğ½ĞµĞ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ñ‹Ğ¹

#### Project Validation Middleware (`app/middleware/project_validation.py`)
- **ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ñ€Ğ°Ğ² Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñƒ
- **Ğ›Ğ¾Ğ³Ğ¸ĞºĞ°**:
  1. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ `project_id` Ğ¸Ğ· URL Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°
  2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ² Ğ‘Ğ”: `project.user_id == request.state.user_id`
  3. Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°Ñ‚ÑŒ 404 ĞµÑĞ»Ğ¸ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½ Ğ¸Ğ»Ğ¸ Ğ½Ğµ Ğ¿Ñ€Ğ¸Ğ½Ğ°Ğ´Ğ»ĞµĞ¶Ğ¸Ñ‚ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
- **Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ°**: 403 Forbidden/404 Not Found Ğ´Ğ»Ñ Ğ½ĞµĞ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°

---

### Business Logic Layer

#### WorkerSpaceManager (`app/core/worker_space_manager.py`)
- **ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğ¼Ğ¸ Ğ¿Ñ€Ğ¾ÑÑ‚Ñ€Ğ°Ğ½ÑÑ‚Ğ²Ğ°Ğ¼Ğ¸ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¾Ğ²
- **ĞÑ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ**:
  - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ñ‹Ñ… worker space Ğ¿Ñ€Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
  - ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… worker spaces Ğ² Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸
  - Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ worker spaces Ğ¿Ñ€Ğ¸ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
  - ĞŸÑ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°Ğ¼ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
- **Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°**:
  ```python
  class WorkerSpaceManager:
      _spaces: Dict[UUID, ProjectWorkerSpace] = {}
      
      async def create_worker_space(self, project_id: UUID) -> ProjectWorkerSpace
      async def get_worker_space(self, project_id: UUID) -> ProjectWorkerSpace
      async def delete_worker_space(self, project_id: UUID) -> None
  ```

#### Agent Manager (`app/agents/manager.py`)
- **ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
- **CRUD Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸**:
  - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ°Ğ³ĞµĞ½Ñ‚Ğ° Ñ Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹ Qdrant ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ°
  - Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
  - ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸
  - Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ°Ğ³ĞµĞ½Ñ‚Ğ° Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ¾Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ°
- **Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ**:
  - PostgreSQL: Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
  - Qdrant: ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸ Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
  - Redis: ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹

#### Contextual Agent (`app/agents/contextual_agent.py`)
- **ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡ Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ ÑĞµĞ¼Ğ°Ğ½Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸
- **ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°**:
  ```
  Input (Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ°)
    â†“
  Retrieve Context (RAG Ğ¸Ğ· Qdrant)
    â†“
  Build Prompt (Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ¼ + system prompt)
    â†“
  Call LLM (OpenAI/LiteLLM)
    â†“
  Store Interaction (Ğ² Qdrant ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°)
    â†“
  Return Response
  ```
- **RAG Integration**:
  - Ğ’ĞµĞºÑ‚Ğ¾Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ² embedding
  - ĞŸĞ¾Ğ¸ÑĞº K Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ñ… Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğ¹ Ğ² Qdrant
  - Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ° Ğ² prompt
  - Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ğ´Ğ»Ñ Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ¹ Ñ€ĞµĞ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

#### Agent Bus (`app/core/agent_bus.py`)
- **ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: ĞšĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸
- **ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°**: asyncio.Queue per agent
- **Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸**:
  - Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ² Ğ¿Ñ€Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğ¸
  - Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑĞ¼Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡
  - ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»Ğ¸Ğ·Ğ¼Ğ° (concurrency_limit)
  - ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² Ğ¸ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
  - ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ (ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹Ğµ, Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸, Ğ²Ñ€ĞµĞ¼Ñ)

#### Orchestrator (`app/core/orchestrator.py`)
- **ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡
- **ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼**:
  1. ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ²Ñ…Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°
  2. Ğ Ğ°Ğ·Ğ±Ğ¸ĞµĞ½Ğ¸Ğµ Ğ½Ğ° Ğ¿Ğ¾Ğ´Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸
  3. ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ² Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ Ğ¿Ğ¾Ğ´Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸
  4. ĞŸĞ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ğµ DAG (directed acyclic graph)
  5. ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾Ğµ/Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ
  6. ĞĞ³Ñ€ĞµĞ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
- **ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸**: Ğ²Ñ€ĞµĞ¼Ñ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ, Ğ²Ñ€ĞµĞ¼Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ, ÑƒÑĞ¿ĞµÑ…

#### Approval Manager (`app/core/approval.py`)
- **ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
- **Ğ¢Ğ¸Ğ¿Ñ‹ Ğ¾Ğ´Ğ¾Ğ±Ñ€ĞµĞ½Ğ¸Ğ¹**:
  - Tool approval (Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚)
  - Plan approval (Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½)
- **ĞŸÑ€Ğ¾Ñ†ĞµÑÑ**:
  1. ĞĞ³ĞµĞ½Ñ‚ Ğ¸Ğ»Ğ¸ Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€ Ğ·Ğ°Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°ÑÑ‚ Ğ¾Ğ´Ğ¾Ğ±Ñ€ĞµĞ½Ğ¸Ğµ
  2. ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ÑÑ SSE ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
  3. ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´Ğ°ĞµÑ‚ Ğ¸Ğ»Ğ¸ Ğ¾Ñ‚ĞºĞ»Ğ¾Ğ½ÑĞµÑ‚
  4. ĞĞ³ĞµĞ½Ñ‚ Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ¸Ğ»Ğ¸ Ğ¾Ñ‚Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ
- **Timeout**: 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ

#### Stream Manager (`app/core/stream_manager.py`)
- **ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ SSE Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ°Ğ¼Ğ¸ Ğ¸ Ğ±ÑƒÑ„ĞµÑ€Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹
- **Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸**:
  - ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ° Ğ½Ğ° ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ ÑĞµÑÑĞ¸Ğ¸
  - ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ Ğ²ÑĞµĞ¼ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‡Ğ¸ĞºĞ°Ğ¼
  - Ğ‘ÑƒÑ„ĞµÑ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ² Redis (FIFO, 100 ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹, TTL 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚)
  - ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¸ Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸
  - Heartbeat Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ñ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ

---

## ğŸ—„ï¸ Data Layer

### PostgreSQL Database

**Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹**:
```
users
â”œâ”€ id (UUID PK)
â”œâ”€ email (unique)
â””â”€ created_at

user_projects
â”œâ”€ id (UUID PK)
â”œâ”€ user_id (FK â†’ users)
â”œâ”€ name (varchar)
â”œâ”€ workspace_path (varchar, nullable)
â”œâ”€ created_at
â””â”€ updated_at

user_agents
â”œâ”€ id (UUID PK)
â”œâ”€ project_id (FK â†’ user_projects)
â”œâ”€ user_id (FK â†’ users, denormalized for performance)
â”œâ”€ name (varchar)
â”œâ”€ status (enum: ready/busy/error)
â”œâ”€ config (jsonb: system_prompt, model, tools, etc)
â”œâ”€ created_at
â””â”€ updated_at

chat_sessions
â”œâ”€ id (UUID PK)
â”œâ”€ project_id (FK â†’ user_projects)
â”œâ”€ user_id (FK â†’ users)
â”œâ”€ created_at
â””â”€ updated_at

messages
â”œâ”€ id (UUID PK)
â”œâ”€ session_id (FK â†’ chat_sessions)
â”œâ”€ user_id (FK â†’ users)
â”œâ”€ agent_id (FK â†’ user_agents, nullable)
â”œâ”€ role (enum: user/assistant/system)
â”œâ”€ content (text)
â”œâ”€ timestamp
â””â”€ metadata (jsonb)
```

### Redis Cache

**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ’Ñ‹ÑĞ¾ĞºĞ¾ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚Ğ½Ğ¾Ğ¹ ĞºÑÑˆ Ğ¸ Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸

**Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…**:
```
Keys:
agent_config:{agent_id}              â†’ JSON ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
agent_status:{agent_id}              â†’ ÑÑ‚Ñ€Ğ¾ĞºĞ° ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°
session_events:{session_id}          â†’ List (FIFO Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹)
user_sessions:{user_id}             â†’ Set Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… ÑĞµÑÑĞ¸Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ

Queues:
agent_task_queue:{agent_id}         â†’ asyncio.Queue Ğ´Ğ»Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡
```

**TTLs**:
- ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ¸ Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ²: 1 Ñ‡Ğ°Ñ
- Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ ÑĞµÑÑĞ¸Ğ¸: 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚
- Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑÑ‹: 10 Ğ¼Ğ¸Ğ½ÑƒÑ‚

### Qdrant Vector Database

**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ¥Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ ÑĞ¼Ğ±ĞµĞ´Ğ´Ğ¸Ğ½Ğ³Ğ¾Ğ² Ğ¸ RAG Ğ¿Ğ¾Ğ¸ÑĞº

**ĞšĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ğ¸** (per agent):
```
{agent_id}_context
â”œâ”€ Points: ÑĞ¼Ğ±ĞµĞ´Ğ´Ğ¸Ğ½Ğ³Ğ¸ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğ¹
â”œâ”€ Payload:
â”‚  â”œâ”€ agent_id (string)
â”‚  â”œâ”€ user_id (string)
â”‚  â”œâ”€ project_id (string)
â”‚  â”œâ”€ session_id (string, optional)
â”‚  â”œâ”€ content (text, indexed)
â”‚  â”œâ”€ interaction_type (enum: task/tool/direct_call)
â”‚  â”œâ”€ timestamp (datetime)
â”‚  â”œâ”€ success (boolean)
â”‚  â”œâ”€ tags (array: Ğ´Ğ»Ñ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸)
â”‚  â””â”€ metadata (object: Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ)
â”œâ”€ Vectors: 1536-dim (OpenAI embeddings)
â””â”€ Search: semantic + metadata filtering
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ**:
```python
# RAG Ğ¿Ğ¾Ğ¸ÑĞº Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸ĞµĞ¹
results = await qdrant.search(
    collection_name=f"{agent_id}_context",
    query_vector=embedding,
    query_filter=Filter(
        must=[
            HasPayload(key="agent_id", value=agent_id),
            Range(key="timestamp", gte=week_ago)
        ]
    ),
    limit=5
)
```

---

## ğŸ”„ ĞŸĞ¾Ñ‚Ğ¾ĞºĞ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 1: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
User â†’ POST /my/projects/
  â†“
User Isolation Middleware (extract user_id)
  â†“
ProjectCreate validation
  â†“
Create UserProject in DB
  â†“
Initialize Starter Pack (3 agents: CodeAssistant, DataAnalyst, DocumentWriter)
  â†“
For each agent:
  â”œâ”€ Create UserAgent in DB
  â”œâ”€ Initialize Qdrant collection
  â””â”€ Cache config in Redis
  â†“
Create ProjectWorkerSpace
  â†“
Return ProjectResponse
```

### Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 2: ĞŸÑ€ÑĞ¼Ğ¾Ğ¹ Ğ²Ñ‹Ğ·Ğ¾Ğ² Ğ°Ğ³ĞµĞ½Ñ‚Ğ° (âš¡ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾)

```
User â†’ POST /my/projects/{pid}/chat/{sid}/message/ with target_agent="CodeAssistant"
  â†“
User Isolation + Project Validation
  â†“
Save user message to DB
  â†“
Get agent from cache/DB
  â†“
Contextual Agent:
  â”œâ”€ Retrieve context from Qdrant (RAG)
  â”œâ”€ Build prompt with system_prompt + context
  â”œâ”€ Call LLM (with timeout)
  â”œâ”€ Stream response to client (SSE)
  â””â”€ Store interaction in Qdrant
  â†“
Save agent message to DB
  â†“
Emit SSE event (agent_completed)
```

### Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 3: ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼ (ğŸ§  Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½ĞµĞµ)

```
User â†’ POST /my/projects/{pid}/chat/{sid}/message/ without target_agent
  â†“
User Isolation + Project Validation
  â†“
Save user message to DB
  â†“
Emit SSE event (message_received)
  â†“
Orchestrator:
  â”œâ”€ Analyze request
  â”œâ”€ Plan task DAG
  â”œâ”€ Identify required agents
  â””â”€ Emit SSE event (plan_created)
  â†“
For each task in DAG (parallel where possible):
  â”œâ”€ Get agent from bus
  â”œâ”€ Send task to agent_task_queue
  â”œâ”€ Agent executes (with RAG + Qdrant)
  â”œâ”€ Emit SSE events (agent_started, agent_working, agent_completed)
  â””â”€ Store results in message chain
  â†“
Aggregate results
  â†“
Save final message to DB
  â†“
Emit SSE event (orchestration_completed)
```

---

## ğŸ“Š ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ

### Ğ“Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

- **Stateless API**: ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ N Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑĞ¾Ğ² FastAPI
- **Shared Redis**: Ğ”Ğ»Ñ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑĞ°Ğ¼Ğ¸
- **Shared PostgreSQL**: Ğ”Ğ»Ñ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ
- **Shared Qdrant**: Ğ”Ğ»Ñ RAG Ğ¿Ğ¾Ğ¸ÑĞºĞ°

### Ğ’ĞµÑ€Ñ‚Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

- **Worker Spaces in Memory**: ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¾Ğ²
- **Async I/O**: Ğ’ÑĞµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ async Ğ´Ğ»Ñ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ CPU
- **Connection Pooling**: PostgreSQL asyncpg, Redis connection pooling

### ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

- **ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ¾Ğ² Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ² Ğ² Redis**: Ğ˜Ğ·Ğ±ĞµĞ¶Ğ°Ñ‚ÑŒ Ñ‡Ğ°ÑÑ‚Ñ‹Ñ… DB Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
- **Lazy loading ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²**: Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞºĞ¾Ğ³Ğ´Ğ° Ğ½ÑƒĞ¶Ğ½Ğ¾
- **Burstable concurrency**: Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ concurrency_limit
- **Batch operations**: Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹ Ğ´Ğ»Ñ Ğ‘Ğ”

---

## ğŸ” Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

### User Isolation

- **Middleware-level**: Ğ’ÑĞµ `/my/*` endpoints Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‚ JWT
- **Database-level**: Ğ—Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ÑƒÑÑ‚ÑÑ Ğ¿Ğ¾ `user_id`
- **Application-level**: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ownership Ğ¿ĞµÑ€ĞµĞ´ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸ÑĞ¼Ğ¸
- **Metric**: `USER_ISOLATION_VIOLATIONS` Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ = 0

### Authentication

- **JWT Bearer Tokens**: Stateless Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ
- **Token Claims**: `sub` (user UUID), `iat` (issued at), `exp` (expiration)
- **Secret Key**: ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ· `JWT_SECRET_KEY`
- **Token Validation**: ĞĞ° ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ `/my/*` Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ

### Authorization

- **Per-Project ACL**: ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ²Ğ¸Ğ´Ğ¸Ñ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑĞ²Ğ¾Ğ¸ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ‹
- **Per-Agent ACL**: ĞĞ³ĞµĞ½Ñ‚Ñ‹ Ğ¿Ñ€Ğ¸Ğ²ÑĞ·Ğ°Ğ½Ñ‹ Ğº Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñƒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
- **Approval Workflow**: ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‚ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ñ

---

## ğŸ“ˆ ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸

### Prometheus Metrics

```
# Counters
projects_created_total{user_id}
agents_created_total{project_id}
messages_sent_total{project_id}
direct_calls_total{agent_id}
orchestrations_total{project_id}

# Histograms
agent_execution_seconds{agent_id,status}
orchestration_planning_seconds{project_id}
qdrant_search_latency_seconds{agent_id}
user_isolation_check_duration_seconds

# Gauges
active_projects_count
active_agents_count
redis_queue_size{agent_id}
qdrant_collection_size{agent_id}
```

### Health Checks

- **GET /health** - Ğ±Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ²ÑĞµĞ³Ğ´Ğ° Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ 200)
- **GET /ready** - Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹ (PostgreSQL, Redis, Qdrant)

---

## ğŸš€ Ğ Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ

### Docker Compose (local development)

```yaml
services:
  api:
    image: codelab-core-service:latest
    ports: [8000:8000]
    depends_on: [postgres, redis, qdrant]
  
  postgres:
    image: postgres:16
    environment:
      POSTGRES_DB: codelab
  
  redis:
    image: redis:7
  
  qdrant:
    image: qdrant/qdrant:v1.7.1
```

### Kubernetes (production)

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: codelab-core-service
spec:
  replicas: 3
  selector:
    matchLabels:
      app: codelab
  template:
    spec:
      containers:
      - name: api
        image: codelab-core-service:v0.2.0
        ports:
        - containerPort: 8000
        livenessProbe:
          httpGet:
            path: /health
            port: 8000
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 8000
          initialDelaySeconds: 10
          periodSeconds: 5
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: codelab-secrets
              key: database-url
```

---

## ğŸ“š Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ€ĞµÑÑƒÑ€ÑÑ‹

- [REST API Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ](./rest-api.md)
- [Component Details](./component-details.md)
- [Developer Guide](./developer-guide.md)
- [Deployment Guide](./deployment-guide.md)
- [ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ ĞºĞ¾Ğ´Ğ°](../samples.md)
