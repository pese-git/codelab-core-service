# –û—Ç—á–µ—Ç –æ –ø—Ä–æ–≤–µ—Ä–∫–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ OpenSpec –∏ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 13 —Ñ–µ–≤—Ä–∞–ª—è 2026  
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** v1.0  
**–ü—Ä–æ–≤–µ—Ä—è—é—â–∏–π:** Roo AI

---

## üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ OpenSpec

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–≥—Ä–µ—Å—Å | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|-----------|--------|----------|-----------|
| User Isolation Middleware | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω | 100% | HIGH |
| Database Models | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω | 100% | HIGH |
| Pydantic Schemas | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω | 100% | HIGH |
| Agent Context Store | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω | 100% | HIGH |
| Personal Agents Management | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω | 100% | HIGH |
| Agent Bus Messaging | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω | 100% | MEDIUM |
| Chat System (Direct Mode) | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω | 100% | HIGH |
| SSE Event Streaming | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω | 100% | HIGH |
| REST API Endpoints | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω | 85% | HIGH |
| **User Worker Space** | ‚ùå **–ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** | **0%** | **CRITICAL** |
| **Personal Orchestrator** | ‚ùå **–ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** | **0%** | **HIGH** |
| **Approval Manager** | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | 30% | HIGH |
| Testing Framework | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | 40% | MEDIUM |
| Monitoring Setup | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | 20% | LOW |

**–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å:** ~65% –æ—Ç –ø–æ–ª–Ω–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

---

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

### 1. User Isolation Middleware ‚úÖ
**–§–∞–π–ª:** [`app/middleware/user_isolation.py`](app/middleware/user_isolation.py)

**–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏:**
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ user_id –∏–∑ JWT —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –ò–Ω—ä–µ–∫—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ request.state
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–ª—è `/my/*` endpoints
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (401/403)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –¥–æ—Å—Ç—É–ø–∞

**–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

---

### 2. Database Models ‚úÖ
**–§–∞–π–ª—ã:** [`app/models/`](app/models/)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏:**
- ‚úÖ [`User`](app/models/user.py) - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ [`UserAgent`](app/models/user_agent.py) - –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã
- ‚úÖ [`UserOrchestrator`](app/models/user_orchestrator.py) - –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä—ã
- ‚úÖ [`ChatSession`](app/models/chat_session.py) - —á–∞—Ç-—Å–µ—Å—Å–∏–∏
- ‚úÖ [`Message`](app/models/message.py) - —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ [`Task`](app/models/task.py) - –∑–∞–¥–∞—á–∏ –∞–≥–µ–Ω—Ç–æ–≤
- ‚úÖ [`ApprovalRequest`](app/models/approval_request.py) - –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚úÖ [`migrations/versions/2026_02_11_2215-001_initial_schema.py`](migrations/versions/2026_02_11_2215-001_initial_schema.py)
- ‚úÖ –í—Å–µ –∏–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ Foreign keys –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ Cascade delete –ø—Ä–∞–≤–∏–ª–∞

**–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

---

### 3. Pydantic Schemas ‚úÖ
**–§–∞–π–ª—ã:** [`app/schemas/`](app/schemas/)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Å—Ö–µ–º—ã:**
- ‚úÖ [`AgentConfig, AgentResponse`](app/schemas/agent.py)
- ‚úÖ [`ChatSessionResponse, MessageRequest, MessageResponse`](app/schemas/chat.py)
- ‚úÖ [`ApprovalRequest, ApprovalResponse`](app/schemas/approval.py)
- ‚úÖ [`SSEEvent`](app/schemas/event.py)
- ‚úÖ [`TaskPlan, TaskResponse`](app/schemas/task.py)
- ‚úÖ [`ErrorResponse`](app/schemas/error.py)

**–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

---

### 4. Agent Context Store (Qdrant) ‚úÖ
**–§–∞–π–ª:** [`app/vectorstore/agent_context_store.py`](app/vectorstore/agent_context_store.py)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ per-agent –∫–æ–ª–ª–µ–∫—Ü–∏–π (`user{id}_{agent_name}_context`)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π —Å embeddings
- ‚úÖ Hybrid search (vector + metadata filtering)
- ‚úÖ –û–ø–µ—Ä–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é (clear, prune)
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

**–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

---

### 5. Personal Agents Management ‚úÖ
**–§–∞–π–ª:** [`app/agents/manager.py`](app/agents/manager.py)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ agent_id
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (Pydantic)
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∞–≥–µ–Ω—Ç–∞
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –≤ Redis (TTL 5 –º–∏–Ω)
- ‚úÖ –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (agent + Qdrant collection + cache)

**–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

---

### 6. Agent Bus Messaging ‚úÖ
**–§–∞–π–ª:** [`app/core/agent_bus.py`](app/core/agent_bus.py)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- ‚úÖ asyncio.Queue per agent
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–æ–≤ —Å max_concurrency
- ‚úÖ –î–µ—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å graceful shutdown
- ‚úÖ Worker tasks –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—á–µ—Ä–µ–¥–µ–π
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å concurrency (max 3 –∑–∞–¥–∞—á–∏)
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–¥–∞—á
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ (queue_size, active_tasks)

**–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

---

### 7. Chat System (Direct Mode) ‚úÖ
**–§–∞–π–ª:** [`app/routes/chat.py`](app/routes/chat.py)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- ‚úÖ –ï–¥–∏–Ω—ã–π endpoint `POST /my/chat/{session_id}/message/`
- ‚úÖ Direct mode execution (—Å target_agent)
- ‚úÖ Session management (create, list, get, delete)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ message history –≤ –ë–î
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- ‚úÖ Context injection –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤

**–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è SQLAlchemy lazy loading –≤ async context (—Å–º. TEST_REPORT.md)
- ‚ö†Ô∏è Orchestrated mode –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (—Ç—Ä–µ–±—É–µ—Ç Orchestrator)

**–°—Ç–∞—Ç—É—Å:** Direct mode –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, Orchestrated mode –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

---

### 8. SSE Event Streaming ‚úÖ
**–§–∞–π–ª—ã:** 
- [`app/routes/sse.py`](app/routes/sse.py)
- [`app/core/sse_manager.py`](app/core/sse_manager.py)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- ‚úÖ SSE endpoint `GET /my/sse/{session_id}`
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö connections per session
- ‚úÖ –í—Å–µ —Ç–∏–ø—ã —Å–æ–±—ã—Ç–∏–π –∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ JSON serialization –¥–ª—è —Å–æ–±—ã—Ç–∏–π
- ‚úÖ Heartbeat –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è connections (30 —Å–µ–∫)
- ‚úÖ Graceful close –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
- ‚úÖ Event buffering –≤ Redis
- ‚úÖ Broadcasting —Å–æ–±—ã—Ç–∏–π –≤—Å–µ–º connections
- ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

**–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

---

### 9. REST API Endpoints ‚úÖ
**–§–∞–π–ª—ã:** [`app/routes/`](app/routes/)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ endpoints:**
- ‚úÖ Agent management: `GET/POST/PUT/DELETE /my/agents/`
- ‚úÖ Chat: `POST/GET/DELETE /my/chat/sessions/`, `POST /my/chat/{session_id}/message/`
- ‚úÖ SSE: `GET /my/sse/{session_id}`
- ‚úÖ Health: `GET /health`
- ‚úÖ JWT authentication –Ω–∞ –≤—Å–µ—Ö `/my/*` endpoints
- ‚úÖ JSON Schema validation (Pydantic)
- ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ error responses
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ Swagger/OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ `/docs`

**–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ endpoints:**
- ‚ùå Orchestrator configuration: `GET/PUT /my/orchestrator/config`
- ‚ùå Approval endpoints: `GET/POST /my/approvals/`, `POST /my/approvals/{id}/confirm`
- ‚ùå Context management: `GET/POST/DELETE /my/agents/{id}/context/`

**–°—Ç–∞—Ç—É—Å:** –û—Å–Ω–æ–≤–Ω—ã–µ endpoints —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã (85%), —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç

---

## ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤ –∫–æ–¥–µ

### 1. User Worker Space ‚ùå **–ö–†–ò–¢–ò–ß–ù–û**
**–û–∂–∏–¥–∞–µ–º—ã–π —Ñ–∞–π–ª:** `app/workers/user_worker_space.py` –∏–ª–∏ `app/core/user_worker_space.py`

**–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å–æ–≥–ª–∞—Å–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏:**
- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–∞–±–æ—á–µ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ agent_cache (–∑–∞–≥—Ä—É–∑–∫–∞, –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è, –æ—á–∏—Å—Ç–∫–∞)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Agent Bus (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–¥–µ—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–æ–≤)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Qdrant (–¥–æ—Å—Ç—É–ø –∫ per-agent collections)
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –º–µ–∂–¥—É direct –∏ orchestrated —Ä–µ–∂–∏–º–∞–º–∏
- Lifecycle management (initialization, cleanup, reset)
- Graceful cleanup –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Å–µ—Å—Å–∏–∏
- Crash recovery
- –ò–∑–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É Worker Spaces —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ú–µ—Ç—Ä–∏–∫–∏ (active_agents, cache_size, queue_size)

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:** 
- ‚ùå –ö–ª–∞—Å—Å `UserWorkerSpace` –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ
- ‚ùå –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ø–æ —Ä–∞–∑–Ω—ã–º –º–æ–¥—É–ª—è–º –±–µ–∑ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚ùå –ù–µ—Ç –µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–∏—Å—Ç–µ–º—É:**
- üî¥ **–ö–†–ò–¢–ò–ß–ù–û** - –ë–µ–∑ Worker Space –Ω–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- üî¥ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏ (direct/orchestrated) –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- üî¥ Lifecycle management –∞–≥–µ–Ω—Ç–æ–≤ –Ω–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω
- üî¥ –ù–µ—Ç –µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–æ–∑–¥–∞—Ç—å `app/core/user_worker_space.py` —Å –∫–ª–∞—Å—Å–æ–º `UserWorkerSpace`

---

### 2. Personal Orchestrator ‚ùå **–í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢**
**–û–∂–∏–¥–∞–µ–º—ã–π —Ñ–∞–π–ª:** `app/core/orchestrator.py` –∏–ª–∏ `app/agents/orchestrator.py`

**–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å–æ–≥–ª–∞—Å–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏:**
- –ö–ª–∞—Å—Å `PersonalOrchestrator` –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á
- –ê–Ω–∞–ª–∏–∑ natural language –∑–∞–ø—Ä–æ—Å–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∞ –∑–∞–¥–∞—á —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –í—ã–±–æ—Ä –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤ –¥–ª—è –∑–∞–¥–∞—á
- –û—Ü–µ–Ω–∫–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (LLM API calls)
- –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Approval Manager
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞–Ω–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (partial success, failed tasks)
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞–Ω–æ–≤ –≤ Redis (TTL 24 —á–∞—Å–∞)

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:**
- ‚ùå –ö–ª–∞—Å—Å `PersonalOrchestrator` –Ω–µ –Ω–∞–π–¥–µ–Ω
- ‚úÖ –ú–æ–¥–µ–ª—å `UserOrchestrator` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î
- ‚ùå –õ–æ–≥–∏–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- ‚ùå Orchestrated mode –≤ Chat System –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–∏—Å—Ç–µ–º—É:**
- üü° **–í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢** - Orchestrated mode –Ω–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- üü° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
- üü° –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ direct mode

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–æ–∑–¥–∞—Ç—å `app/core/orchestrator.py` —Å –∫–ª–∞—Å—Å–æ–º `PersonalOrchestrator`

---

### 3. Approval Manager ‚ö†Ô∏è **–ß–ê–°–¢–ò–ß–ù–û –†–ï–ê–õ–ò–ó–û–í–ê–ù**
**–û–∂–∏–¥–∞–µ–º—ã–π —Ñ–∞–π–ª:** `app/core/approval_manager.py`

**–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ö–ª–∞—Å—Å `ApprovalManager` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è approvals
- Tool approval workflow
- Plan approval workflow
- Timeout management (300 —Å–µ–∫)
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ timeout
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SSE –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ approval_required —Å–æ–±—ã—Ç–∏–π
- –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ—Å–ª–µ approve/reject
- –•—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ approvals –≤ –ë–î
- Risk level assessment
- Auto-approve –¥–ª—è low risk tools (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- Retry mechanism —Å –ª–∏–º–∏—Ç–æ–º
- Batch approval
- –ú–µ—Ç—Ä–∏–∫–∏ (approval_rate, timeout_rate, response_time)

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:**
- ‚úÖ –ú–æ–¥–µ–ª—å `ApprovalRequest` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î
- ‚úÖ –°—Ö–µ–º—ã `ApprovalRequest`, `ApprovalResponse` —Å—É—â–µ—Å—Ç–≤—É—é—Ç
- ‚ùå –ö–ª–∞—Å—Å `ApprovalManager` –Ω–µ –Ω–∞–π–¥–µ–Ω
- ‚ùå Endpoints –¥–ª—è approvals –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
- ‚ùå Workflow –ª–æ–≥–∏–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–∏—Å—Ç–µ–º—É:**
- üü° –ö–æ–Ω—Ç—Ä–æ–ª—å –æ–ø–∞—Å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- üü° Plan approval –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- üü° –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã —Å–Ω–∏–∂–µ–Ω–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–æ–∑–¥–∞—Ç—å `app/core/approval_manager.py` –∏ `app/routes/approvals.py`

---

## ‚ö†Ô∏è –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –º–µ–∂–¥—É —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π

### 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è

#### User Worker Space –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
**–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º —á–µ—Ä–µ–∑ –∫–ª–∞—Å—Å `UserWorkerSpace`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∞:
- Agent management –≤ `app/agents/manager.py`
- Agent Bus –≤ `app/core/agent_bus.py`
- SSE Manager –≤ `app/core/sse_manager.py`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏, lifecycle management –Ω–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω

---

#### Orchestrated Mode –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:** –î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã - Direct –∏ Orchestrated

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –¢–æ–ª—å–∫–æ Direct mode —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç

**–ö–æ–¥ –≤ [`app/routes/chat.py`](app/routes/chat.py:159-165):**
```python
if target_agent:
    # Direct mode - —Ä–∞–±–æ—Ç–∞–µ—Ç
    ...
else:
    # Orchestrated mode - –∑–∞–≥–ª—É—à–∫–∞
    return MessageResponse(
        id=uuid4(),
        role="assistant",
        content="Orchestrated mode not yet implemented",
        ...
    )
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á

---

### 2. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ endpoints

–°–æ–≥–ª–∞—Å–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ [`openspec/changes/implement-core-service/specs/rest-api-endpoints/spec.md`](openspec/changes/implement-core-service/specs/rest-api-endpoints/spec.md), –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:

**–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ:**
- ‚ùå `GET /my/orchestrator/config` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- ‚ùå `PUT /my/orchestrator/config` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚ùå `GET /my/approvals/` - —Å–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
- ‚ùå `POST /my/approvals/{id}/confirm` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
- ‚ùå `GET /my/agents/{id}/context/` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∞–≥–µ–Ω—Ç–∞
- ‚ùå `POST /my/agents/{id}/context/` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç
- ‚ùå `DELETE /my/agents/{id}/context/` - –æ—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

---

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:** 90%+ code coverage, unit + integration —Ç–µ—Å—Ç—ã

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ 5 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω—ã
- ‚ö†Ô∏è 61% —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç (—Å–º. [`tests/TEST_REPORT.md`](tests/TEST_REPORT.md))
- ‚ùå Coverage –Ω–µ –∏–∑–º–µ—Ä–µ–Ω
- ‚ùå Load —Ç–µ—Å—Ç—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
- ‚ùå Security audit —Ç–µ—Å—Ç—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç

**–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- SQLAlchemy lazy loading –≤ async context
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è Orchestrator (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è Approval Manager (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)

---

## üìã –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- ‚úÖ [`README.md`](README.md) - –∞–∫—Ç—É–∞–ª–µ–Ω, –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- ‚úÖ [`doc/architecture/system-overview.md`](doc/architecture/system-overview.md) - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ [`doc/architecture/component-details.md`](doc/architecture/component-details.md) - –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- ‚úÖ [`doc/rest-api.md`](doc/rest-api.md) - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º endpoints
- ‚úÖ [`doc/sse-event-streaming.md`](doc/sse-event-streaming.md) - –∞–∫—Ç—É–∞–ª–µ–Ω

**–ó–∞–º–µ—á–∞–Ω–∏—è:**
- ‚ö†Ô∏è –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —É–ø–æ–º–∏–Ω–∞–µ—Ç Orchestrator –∫–∞–∫ "–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é"
- ‚ö†Ô∏è Approval Manager –æ–ø–∏—Å–∞–Ω –∫–∞–∫ "–±—É–¥—É—â–µ–µ —É–ª—É—á—à–µ–Ω–∏–µ"
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —á–µ—Å—Ç–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —ç—Ç–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (MUST HAVE)

1. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å User Worker Space** 
   - –°–æ–∑–¥–∞—Ç—å `app/core/user_worker_space.py`
   - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
   - **–û—Ü–µ–Ω–∫–∞:** 3-4 –¥–Ω—è

2. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Personal Orchestrator**
   - –°–æ–∑–¥–∞—Ç—å `app/core/orchestrator.py`
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∞ –∑–∞–¥–∞—á
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å Chat System
   - **–û—Ü–µ–Ω–∫–∞:** 4-5 –¥–Ω–µ–π

3. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å SQLAlchemy lazy loading**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `selectinload` –∏–ª–∏ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã
   - –ò—Å–ø—Ä–∞–≤–∏—Ç—å [`app/routes/chat.py:68`](app/routes/chat.py:68) –∏ [`app/routes/chat.py:124`](app/routes/chat.py:124)
   - **–û—Ü–µ–Ω–∫–∞:** 1-2 —á–∞—Å–∞

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (SHOULD HAVE)

4. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Approval Manager**
   - –°–æ–∑–¥–∞—Ç—å `app/core/approval_manager.py`
   - –°–æ–∑–¥–∞—Ç—å `app/routes/approvals.py`
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å SSE –∏ Orchestrator
   - **–û—Ü–µ–Ω–∫–∞:** 3-4 –¥–Ω—è

5. **–î–æ–±–∞–≤–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ endpoints**
   - Orchestrator config endpoints
   - Approval endpoints
   - Context management endpoints
   - **–û—Ü–µ–Ω–∫–∞:** 2-3 –¥–Ω—è

6. **–£–ª—É—á—à–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ**
   - –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–≤–∞–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
   - –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –î–æ—Å—Ç–∏—á—å 90%+ coverage
   - **–û—Ü–µ–Ω–∫–∞:** 3-4 –¥–Ω—è

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (NICE TO HAVE)

7. **–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Prometheus metrics
   - –°–æ–∑–¥–∞—Ç—å Grafana dashboards
   - **–û—Ü–µ–Ω–∫–∞:** 2-3 –¥–Ω—è

8. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
   - –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—É—Ç–µ–π
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è database queries
   - **–û—Ü–µ–Ω–∫–∞:** 2-3 –¥–Ω—è

---

## üìä Roadmap –¥–æ –ø–æ–ª–Ω–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

### –ù–µ–¥–µ–ª—è 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- [ ] –î–µ–Ω—å 1-2: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å User Worker Space
- [ ] –î–µ–Ω—å 3: –ò—Å–ø—Ä–∞–≤–∏—Ç—å SQLAlchemy lazy loading
- [ ] –î–µ–Ω—å 4-5: –ù–∞—á–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é Personal Orchestrator

### –ù–µ–¥–µ–ª—è 2: Orchestrator –∏ Approval Manager
- [ ] –î–µ–Ω—å 1-2: –ó–∞–≤–µ—Ä—à–∏—Ç—å Personal Orchestrator
- [ ] –î–µ–Ω—å 3-4: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Approval Manager
- [ ] –î–µ–Ω—å 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### –ù–µ–¥–µ–ª—è 3: Endpoints –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –î–µ–Ω—å 1-2: –î–æ–±–∞–≤–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ endpoints
- [ ] –î–µ–Ω—å 3-4: –£–ª—É—á—à–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
- [ ] –î–µ–Ω—å 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ù–µ–¥–µ–ª—è 4: –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
- [ ] –î–µ–Ω—å 1-2: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏
- [ ] –î–µ–Ω—å 3-4: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [ ] –î–µ–Ω—å 5: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** 4 –Ω–µ–¥–µ–ª–∏ –¥–æ –ø–æ–ª–Ω–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

---

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ –∑–∞–¥–∞—á–∞–º –∏–∑ tasks.md

### –ò–∑ [`openspec/changes/implement-core-service/tasks.md`](openspec/changes/implement-core-service/tasks.md)

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–∏–∑ 294 –∑–∞–¥–∞—á):**
- ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: ~170 –∑–∞–¥–∞—á (58%)
- ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ: ~30 –∑–∞–¥–∞—á (10%)
- ‚ùå –ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: ~94 –∑–∞–¥–∞—á–∏ (32%)

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –±–ª–æ–∫–∏:**
- ‚ùå –ë–ª–æ–∫ 8: Personal Orchestrator (0/14 –∑–∞–¥–∞—á)
- ‚ùå –ë–ª–æ–∫ 9: Approval Manager (0/14 –∑–∞–¥–∞—á)
- ‚ùå –ë–ª–æ–∫ 10: User Worker Space (0/12 –∑–∞–¥–∞—á)
- ‚ö†Ô∏è –ë–ª–æ–∫ 11: Chat System (8/13 –∑–∞–¥–∞—á, orchestrated mode –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
- ‚ö†Ô∏è –ë–ª–æ–∫ 14: Testing (5/14 –∑–∞–¥–∞—á)
- ‚ö†Ô∏è –ë–ª–æ–∫ 16: Monitoring & Observability (2/10 –∑–∞–¥–∞—á)

---

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è: **65%** üü°

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ User Isolation —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ
- ‚úÖ Database schema –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ Agent management –∏ Context Store —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç–ª–∏—á–Ω–æ
- ‚úÖ SSE Event Streaming –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω
- ‚úÖ Direct mode Chat System —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–µ–ª—ã:**
- ‚ùå User Worker Space –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- ‚ùå Personal Orchestrator –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚ùå Orchestrated mode –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ö†Ô∏è Approval Manager —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚ö†Ô∏è –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–ü—Ä–æ–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ö–æ—Ä–æ—à–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –¥–ª—è MVP —Å Direct Mode, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (Worker Space, Orchestrator, Approval Manager) –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Orchestrated Mode.

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** 
–ù–∞—á–∞—Ç—å —Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ User Worker Space –∫–∞–∫ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

---

**–î–∞—Ç–∞ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–∞:** 13 —Ñ–µ–≤—Ä–∞–ª—è 2026  
**–ê–≤—Ç–æ—Ä:** Roo AI  
**–í–µ—Ä—Å–∏—è –æ—Ç—á–µ—Ç–∞:** 1.0
